(function(e){function t(t){for(var n,r,o=t[0],l=t[1],u=t[2],d=0,f=[];d<o.length;d++)r=o[d],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&f.push(a[r][0]),a[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);c&&c(t);while(f.length)f.shift()();return s.push.apply(s,u||[]),i()}function i(){for(var e,t=0;t<s.length;t++){for(var i=s[t],n=!0,o=1;o<i.length;o++){var l=i[o];0!==a[l]&&(n=!1)}n&&(s.splice(t--,1),e=r(r.s=i[0]))}return e}var n={},a={app:0},s=[];function r(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=n,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var c=l;s.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"021b":function(e,t,i){"use strict";var n=i("30ea"),a=i.n(n);a.a},"1ae4":function(e,t,i){e.exports=i.p+"img/logo.449e66a7.svg"},2221:function(e,t,i){"use strict";var n=i("7b46"),a=i.n(n);a.a},"2df3":function(e,t,i){"use strict";var n=i("ff7a"),a=i.n(n);a.a},"30ea":function(e,t,i){},"56d7":function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("router-view")],1)},s=[],r=(i("fa6d"),{name:"App"}),o=r,l=i("2877"),u=Object(l["a"])(o,a,s,!1,null,null,null),c=u.exports,d=i("8c4f"),f=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"game"}},[e._m(0),i("div",{staticClass:"form-group level"},[i("label",{attrs:{for:"level"}},[e._v("難易度: ")]),i("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedLevelName,expression:"selectedLevelName"}],attrs:{id:"level"},on:{change:[function(t){var i=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.selectedLevelName=t.target.multiple?i:i[0]},e.init]}},e._l(e.levels,(function(t,n){return i("option",{key:t.difficulity},[e._v(e._s(n))])})),0)]),i("div",{staticClass:"game-wrapper text-center"},[i("div",{staticClass:"game"},[i("div",{staticClass:"indicators-wrapper form-group"},[i("div",{staticClass:"indicators"},[i("Digits",{attrs:{value:e.selectedLevelDetail.mineCount,digitSize:3}}),i("div",{staticClass:"face button",on:{click:e.init}},[i("div",{staticClass:"face-background mx-auto"},[i("font-awesome-icon",{staticClass:"fa fa-face",attrs:{size:"3x",icon:e.emotion}})],1)]),i("Digits",{attrs:{value:e.timeSecondsCount,digitSize:3}})],1)]),i("Panel",{attrs:{sizeWidth:e.selectedLevelDetail.sizeWidth,sizeHeight:e.selectedLevelDetail.sizeHeight,mineCount:e.selectedLevelDetail.mineCount},on:{start:e.start,end:e.end}})],1)])])},h=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"logo"},[n("img",{attrs:{src:i("1ae4")}}),n("span",[e._v("マインスイーパー")]),n("img",{attrs:{src:i("1ae4")}})])}],m=(i("caad"),i("b64b"),i("2532"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"form-group",attrs:{id:"panel-wrapper"}},[i("div",{staticClass:"d-inline-block",attrs:{id:"panel"}},e._l(e.tiles,(function(t,n){return i("div",{key:n,staticClass:"row"},e._l(t,(function(t,a){return i("div",{key:a,staticClass:"col"},[i("Tile",{attrs:{row:n,col:a,number:t.number,hasMine:t.hasMine,opened:t.opened,flagged:t.flagged,badFlagged:t.badFlagged,frozen:e.isFrozen},on:{open:e.open,flag:e.flag}})],1)})),0)})),0)])}),p=[],g=(i("99af"),i("4de4"),i("0481"),i("4160"),i("d81d"),i("13d5"),i("a434"),i("4069"),i("a9e3"),i("159b"),i("3835")),v=i("2909"),b=i("5530"),C=i("2f62"),y=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"tile button",class:[{"button-disabled":!e.canOpen}]},[i("input",{attrs:{type:"checkbox",id:e.id,disabled:!e.canOpen},domProps:{checked:e.opened},on:{click:function(t){return e.$emit("open",[e.row,e.col])}}}),i("label",{class:[e.numberClass,e.openedClass,e.mineClass,e.flaggedClass,e.badFlaggedClass],attrs:{for:e.id},on:{contextmenu:function(t){return t.preventDefault(),e.$emit("flag",[e.row,e.col])},touchstart:function(t){return e.touchstart([e.row,e.col])},touchend:e.touchend}}),i("transition",{attrs:{name:"transition-bomb"}},[e.opened&&e.hasMine?i("font-awesome-icon",{staticClass:"fa fa-bomb",attrs:{icon:"bomb",size:"lg"}}):e._e()],1),!e.opened&&e.flagged?i("font-awesome-icon",{staticClass:"fa fa-flag",attrs:{icon:"flag",size:"lg"},on:{contextmenu:function(t){return t.preventDefault(),e.$emit("flag",[e.row,e.col])},touchstart:function(t){return e.touchstart([e.row,e.col])},touchend:e.touchend}}):e._e(),e.opened&&e.badFlagged?i("font-awesome-icon",{staticClass:"fa fa-times",attrs:{icon:"times",size:"lg"}}):e._e()],1)},O=[],w={name:"Tile",data:function(){return{numberClass:"",openedClass:"",mineClass:"",flaggedClass:"",badFlaggedClass:"",timer:null}},props:{row:{type:Number,required:!0},col:{type:Number,required:!0},number:{type:Number,required:!0,default:0},opened:{type:Boolean,default:!1},hasMine:{type:Boolean,default:!1},flagged:{type:Boolean,default:!1},badFlagged:{type:Boolean,default:!1},frozen:{type:Boolean,default:!1}},watch:{number:function(){this.numberClass=this.number>0?"number-".concat(this.number):""},opened:function(){this.openedClass=this.opened?"opened":"",this.mineClass=this.hasMine&&this.opened?"mine":""},flagged:function(){this.flaggedClass=this.flagged?"flagged":""},badFlagged:function(){this.badFlaggedClass=this.badFlagged?"flagged-bad":""}},computed:{id:{get:function(){return"tile-".concat(this.row,"-").concat(this.col)}},canOpen:{get:function(){return!this.opened&&!this.flagged&&!this.frozen}}},methods:{touchstart:function(e){var t=Object(g["a"])(e,2),i=t[0],n=t[1],a=this;this.timer=setTimeout((function(){a.$emit("flag",[i,n]),a.timer=null}),1e3)},touchend:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}}},z=w,_=(i("2df3"),Object(l["a"])(z,y,O,!1,null,null,null)),j=_.exports,M=i("1a92"),N=i.n(M),S=[[[-1,-1],[0,-1],[1,-1]],[[-1,0],[1,0]],[[-1,1],[0,1],[1,1]]],x={name:"Panel",components:{Tile:j},data:function(){return{tiles:[],timers:[]}},props:{sizeWidth:{type:Number,required:!0,default:7},sizeHeight:{type:Number,required:!0,default:9},mineCount:{type:Number,required:!0,default:10}},created:function(){this.init();var e=this;this.$store.subscribeAction((function(t){"initialize"===t.type&&e.init()}))},watch:{sizeWidth:function(){this.init()},sizeHeight:function(){this.init()}},computed:Object(b["a"])(Object(b["a"])(Object(b["a"])({},Object(C["d"])(["isStarted","isCleared","isGameOver"])),Object(C["c"])(["isFrozen"])),{},{safeCountOfRemaining:{get:function(){return this.tiles.reduce((function(e,t){return e+t.reduce((function(e,t){return e+(t.opened||t.hasMine?0:1)}),0)}),0)}},hiddenMineCountOfRemaining:{get:function(){return this.tiles.reduce((function(e,t){return e+t.reduce((function(e,t){return e+(!t.opened&&t.hasMine?1:0)}),0)}),0)}},mineTiles:{get:function(){return this.tiles.map((function(e){return e.filter((function(e){return e.hasMine}))})).flat()}},flaggedTiles:{get:function(){return this.tiles.map((function(e){return e.filter((function(e){return e.flagged}))})).flat()}},closedTiles:{get:function(){return this.tiles.map((function(e){return e.filter((function(e){return!e.opened}))})).flat()}}}),methods:Object(b["a"])(Object(b["a"])({},Object(C["b"])(["startGame","clearGame","gameOver"])),{},{init:function(){this.timers.forEach((function(e){return clearTimeout(e)})),this.timers=[],this._initTiles()},_initTiles:function(){var e=this;this.tiles=Object(v["a"])(Array(this.sizeHeight)).map((function(){return Object(v["a"])(Array(e.sizeWidth)).map((function(){return null}))})),this.tiles.forEach((function(t,i){return t.forEach((function(t,n){t={row:i,col:n,flagged:!1,badFlagged:!1,opened:!1,number:0,hasMine:!1},e.tiles[i].splice(n,1,t)}))}))},start:function(e,t){this.startGame(),this.$emit("start"),this.putMines(e,t),this.applyNumbers()},putMines:function(e,t){var i=0;while(i<this.mineCount){var n=Math.floor(Math.random()*this.sizeWidth),a=Math.floor(Math.random()*this.sizeHeight);this.tiles[a][n].hasMine||t===n&&e===a||(this.tiles[a][n].hasMine=!0,i++)}},applyNumbers:function(){var e=this;this.tiles.forEach((function(t,i){return t.forEach((function(t,n){if(t.hasMine)t.number=-1;else{var a=0;S.forEach((function(t,s){return t.forEach((function(t,r){var o=S[s][r][0],l=S[s][r][1];n+o<0||e.sizeWidth<=n+o||i+l<0||e.sizeHeight<=i+l||e.tiles[i+l][n+o].hasMine&&a++}))})),e.tiles[i][n].number=a}}))}))},flag:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Object(g["a"])(e,3),i=t[0],n=t[1],a=t[2];this.isFrozen||(this.tiles[i][n].flagged=void 0!==a?a:!this.tiles[i][n].flagged)},open:function(e){var t=Object(g["a"])(e,2),i=t[0],n=t[1];if(!this.isFrozen&&!this.tiles[i][n].opened){if(this.isStarted||this.start(i,n),this.openRecursive(i,n),this.tiles[i][n].hasMine)return this.gameOver(),this.$emit("end",!1),void this.openMinesAndFlagsAll();if(0===this.safeCountOfRemaining&&!this.isCleared){var a=this;this.closedTiles.forEach((function(e){return a.flag([e.row,e.col,!0])})),this.clearGame(),this.$emit("end",!0)}}},openRecursive:function(e,t){var i=this;this.tiles[e][t].opened||(this.tiles[e][t].opened=!0,this.tiles[e][t].flagged=!1,0===this.tiles[e][t].number&&S.forEach((function(n,a){return n.forEach((function(n,s){var r=S[a][s][0],o=S[a][s][1];t+r<0||i.sizeWidth<=t+r||e+o<0||i.sizeHeight<=e+o||i.openRecursive(e+o,t+r)}))})))},openMinesAndFlagsAll:function(){this.timers=[];var e=this.mineTiles,t=this.flaggedTiles,i=e.concat(t);N()(i);var n=this;i.forEach((function(e,t){n.timers.push(setTimeout((function(){n.setBadFlagIfNeeded(e.row,e.col),n.tiles[e.row][e.col].opened=!0}),50*(t+1)))}))},setBadFlagIfNeeded:function(e,t){this.tiles[e][t].badFlagged=!this.tiles[e][t].hasMine&&this.tiles[e][t].flagged}})},F=x,E=(i("f7ca"),Object(l["a"])(F,m,p,!1,null,null,null)),L=E.exports,$=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"digits"},e._l(e.digits,(function(e,t){return i("Digit",{key:t,attrs:{number:e}})})),1)},T=[],k=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"digit"},e._l(10,(function(t,n){return i("div",{key:n},[e.number===n?i("div",{staticClass:"display",class:["d"+n]}):e._e()])})),0)},D=[],G={name:"Digit",props:{number:{type:Number,default:0}}},H=G,P=(i("021b"),Object(l["a"])(H,k,D,!1,null,null,null)),W=P.exports,A={name:"Digits",components:{Digit:W},props:{value:{type:Number,default:0},digitSize:{type:Number,default:3}},computed:{digits:{get:function(){for(var e=Math.min(this.value,Math.pow(10,this.digitSize)-1),t=[],i=0;i<this.digitSize;i++){var n=e%10;t.push(n),e=Math.floor(e/10)}return t.reverse()}}}},B=A,q=(i("899e"),Object(l["a"])(B,$,T,!1,null,null,null)),R=q.exports,I={"簡単":{difficulity:0,sizeWidth:9,sizeHeight:9,mineCount:10},"普通":{difficulity:1,sizeWidth:16,sizeHeight:16,mineCount:40},"難しい":{difficulity:2,sizeWidth:30,sizeHeight:16,mineCount:99}},J={name:"Game",components:{Panel:L,Digits:R},data:function(){return{timeSecondsCount:0,timer:null,emotion:"smile"}},computed:{levels:function(){return I},selectedLevelName:{get:function(){return this.$store.state.selectedLevelName},set:function(e){this.$store.commit("selectedLevelName",{value:e})}},selectedLevelDetail:function(){return this.selectedLevelName?this.levels[this.selectedLevelName]:null}},created:function(){Object.keys(this.levels).includes(this.selectedLevelName)||(this.selectedLevelName=Object.keys(this.levels)[0]),this.init()},methods:{init:function(){this.$store.dispatch("initialize"),this.emotion="smile",clearInterval(this.timer),this.timer=null,this.timeSecondsCount=0},start:function(){this.timeSecondsCount=0;var e=this;this.timer=setInterval((function(){return e.timeSecondsCount++}),1e3)},end:function(e){this.emotion=e?"laugh-beam":"dizzy",clearInterval(this.timer)}}},K=J,Q=(i("2221"),Object(l["a"])(K,f,h,!1,null,null,null)),U=Q.exports;n["a"].use(d["a"]);var V=[{path:"/",name:"Game",component:U,meta:{title:"マインスイーパー"}},{path:"*",redirect:{name:"Game"}}],X=new d["a"]({base:"",routes:V});X.beforeEach((function(e,t,i){window.document.title=e.meta.title,i()}));var Y=X,Z=i("0e44");n["a"].use(C["a"]);var ee=new C["a"].Store({state:{isStarted:!1,isCleared:!1,isGameOver:!1,selectedLevelName:""},getters:{isFrozen:function(e){return e.isGameOver||e.isCleared}},mutations:{started:function(e,t){var i=t.value;return e.isStarted=i},cleared:function(e,t){var i=t.value;return e.isCleared=i},gameOver:function(e,t){var i=t.value;return e.isGameOver=i},selectedLevelName:function(e,t){var i=t.value;return e.selectedLevelName=i}},actions:{initialize:function(e){var t=e.commit;t("started",{value:!1}),t("cleared",{value:!1}),t("gameOver",{value:!1})},startGame:function(e){var t=e.commit;t("started",{value:!0})},clearGame:function(e){var t=e.commit;t("cleared",{value:!0})},gameOver:function(e){var t=e.commit;t("gameOver",{value:!0})}},plugins:[Object(Z["a"])({key:"mine-sweeper",storage:window.sessionStorage,paths:["selectedLevelName"]})]}),te=i("ecee"),ie=i("c074"),ne=i("b702"),ae=i("f2d1"),se=i("ad3d");n["a"].config.productionTip=!1,te["c"].add(ie["a"],ne["a"],ae["a"]),n["a"].component("font-awesome-icon",se["a"]),new n["a"]({router:Y,store:ee,render:function(e){return e(c)}}).$mount("#app")},"7b46":function(e,t,i){},"899e":function(e,t,i){"use strict";var n=i("c94b"),a=i.n(n);a.a},c94b:function(e,t,i){},df2f:function(e,t,i){},f7ca:function(e,t,i){"use strict";var n=i("df2f"),a=i.n(n);a.a},ff7a:function(e,t,i){}});
//# sourceMappingURL=app.8e812b8b.js.map